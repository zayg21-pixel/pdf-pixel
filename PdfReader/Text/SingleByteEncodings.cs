using PdfReader.Fonts.Types;
using PdfReader.Models;
using System.Collections.Generic;

namespace PdfReader.Text
{
    /// <summary>
    /// Utility for converting single-byte PDF codes with base encodings
    /// to standard glyph names.
    /// </summary>
    internal static class SingleByteEncodings
    {
        public static readonly PdfString UndefinedCharacter = ".notdef"u8;

        private static readonly PdfString[] standard = new PdfString[]
        {
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            "space"u8,
            "exclam"u8,
            "quotedbl"u8,
            "numbersign"u8,
            "dollar"u8,
            "percent"u8,
            "ampersand"u8,
            "quoteright"u8,
            "parenleft"u8,
            "parenright"u8,
            "asterisk"u8,
            "plus"u8,
            "comma"u8,
            "hyphen"u8,
            "period"u8,
            "slash"u8,
            "zero"u8,
            "one"u8,
            "two"u8,
            "three"u8,
            "four"u8,
            "five"u8,
            "six"u8,
            "seven"u8,
            "eight"u8,
            "nine"u8,
            "colon"u8,
            "semicolon"u8,
            "less"u8,
            "equal"u8,
            "greater"u8,
            "question"u8,
            "at"u8,
            "A"u8,
            "B"u8,
            "C"u8,
            "D"u8,
            "E"u8,
            "F"u8,
            "G"u8,
            "H"u8,
            "I"u8,
            "J"u8,
            "K"u8,
            "L"u8,
            "M"u8,
            "N"u8,
            "O"u8,
            "P"u8,
            "Q"u8,
            "R"u8,
            "S"u8,
            "T"u8,
            "U"u8,
            "V"u8,
            "W"u8,
            "X"u8,
            "Y"u8,
            "Z"u8,
            "bracketleft"u8,
            "backslash"u8,
            "bracketright"u8,
            "asciicircum"u8,
            "underscore"u8,
            "quoteleft"u8,
            "a"u8,
            "b"u8,
            "c"u8,
            "d"u8,
            "e"u8,
            "f"u8,
            "g"u8,
            "h"u8,
            "i"u8,
            "j"u8,
            "k"u8,
            "l"u8,
            "m"u8,
            "n"u8,
            "o"u8,
            "p"u8,
            "q"u8,
            "r"u8,
            "s"u8,
            "t"u8,
            "u"u8,
            "v"u8,
            "w"u8,
            "x"u8,
            "y"u8,
            "z"u8,
            "braceleft"u8,
            "bar"u8,
            "braceright"u8,
            "asciitilde"u8,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            "exclamdown"u8,
            "cent"u8,
            "sterling"u8,
            "fraction"u8,
            "yen"u8,
            "florin"u8,
            "section"u8,
            "currency"u8,
            "quotesingle"u8,
            "quotedblleft"u8,
            "guillemotleft"u8,
            "guilsinglleft"u8,
            "guilsinglright"u8,
            "fi"u8,
            "fl"u8,
            default,
            "endash"u8,
            "dagger"u8,
            "daggerdbl"u8,
            "periodcentered"u8,
            default,
            "paragraph"u8,
            "bullet"u8,
            "quotesinglbase"u8,
            "quotedblbase"u8,
            "quotedblright"u8,
            "guillemotright"u8,
            "ellipsis"u8,
            "perthousand"u8,
            default,
            "questiondown"u8,
            default,
            "grave"u8,
            "acute"u8,
            "circumflex"u8,
            "tilde"u8,
            "macron"u8,
            "breve"u8,
            "dotaccent"u8,
            "dieresis"u8,
            default,
            "ring"u8,
            "cedilla"u8,
            default,
            "hungarumlaut"u8,
            "ogonek"u8,
            "caron"u8,
            "emdash"u8,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            "AE"u8,
            default,
            "ordfeminine"u8,
            default,
            default,
            default,
            default,
            "Lslash"u8,
            "Oslash"u8,
            "OE"u8,
            "ordmasculine"u8,
            default,
            default,
            default,
            default,
            default,
            "ae"u8,
            default,
            default,
            default,
            "dotlessi"u8,
            default,
            default,
            "lslash"u8,
            "oslash"u8,
            "oe"u8,
            "germandbls"u8,
            default,
            default,
            default,
            default
        };

        private static readonly PdfString[] ansi = new PdfString[]
        {
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            "space"u8,
            "exclam"u8,
            "quotedbl"u8,
            "numbersign"u8,
            "dollar"u8,
            "percent"u8,
            "ampersand"u8,
            "quotesingle"u8,
            "parenleft"u8,
            "parenright"u8,
            "asterisk"u8,
            "plus"u8,
            "comma"u8,
            "hyphen"u8,
            "period"u8,
            "slash"u8,
            "zero"u8,
            "one"u8,
            "two"u8,
            "three"u8,
            "four"u8,
            "five"u8,
            "six"u8,
            "seven"u8,
            "eight"u8,
            "nine"u8,
            "colon"u8,
            "semicolon"u8,
            "less"u8,
            "equal"u8,
            "greater"u8,
            "question"u8,
            "at"u8,
            "A"u8,
            "B"u8,
            "C"u8,
            "D"u8,
            "E"u8,
            "F"u8,
            "G"u8,
            "H"u8,
            "I"u8,
            "J"u8,
            "K"u8,
            "L"u8,
            "M"u8,
            "N"u8,
            "O"u8,
            "P"u8,
            "Q"u8,
            "R"u8,
            "S"u8,
            "T"u8,
            "U"u8,
            "V"u8,
            "W"u8,
            "X"u8,
            "Y"u8,
            "Z"u8,
            "bracketleft"u8,
            "backslash"u8,
            "bracketright"u8,
            "asciicircum"u8,
            "underscore"u8,
            "grave"u8,
            "a"u8,
            "b"u8,
            "c"u8,
            "d"u8,
            "e"u8,
            "f"u8,
            "g"u8,
            "h"u8,
            "i"u8,
            "j"u8,
            "k"u8,
            "l"u8,
            "m"u8,
            "n"u8,
            "o"u8,
            "p"u8,
            "q"u8,
            "r"u8,
            "s"u8,
            "t"u8,
            "u"u8,
            "v"u8,
            "w"u8,
            "x"u8,
            "y"u8,
            "z"u8,
            "braceleft"u8,
            "bar"u8,
            "braceright"u8,
            "asciitilde"u8,
            default,
            "Euro"u8,
            default,
            "quotesinglbase"u8,
            "florin"u8,
            "quotedblbase"u8,
            "ellipsis"u8,
            "dagger"u8,
            "daggerdbl"u8,
            "circumflex"u8,
            "perthousand"u8,
            "Scaron"u8,
            "guilsinglleft"u8,
            "OE"u8,
            default,
            "Zcaron"u8,
            default,
            default,
            "quoteleft"u8,
            "quoteright"u8,
            "quotedblleft"u8,
            "quotedblright"u8,
            "bullet"u8,
            "endash"u8,
            "emdash"u8,
            "tilde"u8,
            "trademark"u8,
            "scaron"u8,
            "guilsinglright"u8,
            "oe"u8,
            default,
            "zcaron"u8,
            "Ydieresis"u8,
            default,
            "exclamdown"u8,
            "cent"u8,
            "sterling"u8,
            "currency"u8,
            "yen"u8,
            "brokenbar"u8,
            "section"u8,
            "dieresis"u8,
            "copyright"u8,
            "ordfeminine"u8,
            "guillemotleft"u8,
            "logicalnot"u8,
            default,
            "registered"u8,
            "macron"u8,
            "degree"u8,
            "plusminus"u8,
            "twosuperior"u8,
            "threesuperior"u8,
            "acute"u8,
            "mu"u8,
            "paragraph"u8,
            "periodcentered"u8,
            "cedilla"u8,
            "onesuperior"u8,
            "ordmasculine"u8,
            "guillemotright"u8,
            "onequarter"u8,
            "onehalf"u8,
            "threequarters"u8,
            "questiondown"u8,
            "Agrave"u8,
            "Aacute"u8,
            "Acircumflex"u8,
            "Atilde"u8,
            "Adieresis"u8,
            "Aring"u8,
            "AE"u8,
            "Ccedilla"u8,
            "Egrave"u8,
            "Eacute"u8,
            "Ecircumflex"u8,
            "Edieresis"u8,
            "Igrave"u8,
            "Iacute"u8,
            "Icircumflex"u8,
            "Idieresis"u8,
            "Eth"u8,
            "Ntilde"u8,
            "Ograve"u8,
            "Oacute"u8,
            "Ocircumflex"u8,
            "Otilde"u8,
            "Odieresis"u8,
            "multiply"u8,
            "Oslash"u8,
            "Ugrave"u8,
            "Uacute"u8,
            "Ucircumflex"u8,
            "Udieresis"u8,
            "Yacute"u8,
            "Thorn"u8,
            "germandbls"u8,
            "agrave"u8,
            "aacute"u8,
            "acircumflex"u8,
            "atilde"u8,
            "adieresis"u8,
            "aring"u8,
            "ae"u8,
            "ccedilla"u8,
            "egrave"u8,
            "eacute"u8,
            "ecircumflex"u8,
            "edieresis"u8,
            "igrave"u8,
            "iacute"u8,
            "icircumflex"u8,
            "idieresis"u8,
            "eth"u8,
            "ntilde"u8,
            "ograve"u8,
            "oacute"u8,
            "ocircumflex"u8,
            "otilde"u8,
            "odieresis"u8,
            "divide"u8,
            "oslash"u8,
            "ugrave"u8,
            "uacute"u8,
            "ucircumflex"u8,
            "udieresis"u8,
            "yacute"u8,
            "thorn"u8,
            "ydieresis"u8
        };

        private static readonly PdfString[] macRoman = new PdfString[]
        {
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            "space"u8,
            "exclam"u8,
            "quotedbl"u8,
            "numbersign"u8,
            "dollar"u8,
            "percent"u8,
            "ampersand"u8,
            "quotesingle"u8,
            "parenleft"u8,
            "parenright"u8,
            "asterisk"u8,
            "plus"u8,
            "comma"u8,
            "hyphen"u8,
            "period"u8,
            "slash"u8,
            "zero"u8,
            "one"u8,
            "two"u8,
            "three"u8,
            "four"u8,
            "five"u8,
            "six"u8,
            "seven"u8,
            "eight"u8,
            "nine"u8,
            "colon"u8,
            "semicolon"u8,
            "less"u8,
            "equal"u8,
            "greater"u8,
            "question"u8,
            "at"u8,
            "A"u8,
            "B"u8,
            "C"u8,
            "D"u8,
            "E"u8,
            "F"u8,
            "G"u8,
            "H"u8,
            "I"u8,
            "J"u8,
            "K"u8,
            "L"u8,
            "M"u8,
            "N"u8,
            "O"u8,
            "P"u8,
            "Q"u8,
            "R"u8,
            "S"u8,
            "T"u8,
            "U"u8,
            "V"u8,
            "W"u8,
            "X"u8,
            "Y"u8,
            "Z"u8,
            "bracketleft"u8,
            "backslash"u8,
            "bracketright"u8,
            "asciicircum"u8,
            "underscore"u8,
            "grave"u8,
            "a"u8,
            "b"u8,
            "c"u8,
            "d"u8,
            "e"u8,
            "f"u8,
            "g"u8,
            "h"u8,
            "i"u8,
            "j"u8,
            "k"u8,
            "l"u8,
            "m"u8,
            "n"u8,
            "o"u8,
            "p"u8,
            "q"u8,
            "r"u8,
            "s"u8,
            "t"u8,
            "u"u8,
            "v"u8,
            "w"u8,
            "x"u8,
            "y"u8,
            "z"u8,
            "braceleft"u8,
            "bar"u8,
            "braceright"u8,
            "asciitilde"u8,
            default,
            "Adieresis"u8,
            "Aring"u8,
            "Ccedilla"u8,
            "Eacute"u8,
            "Ntilde"u8,
            "Odieresis"u8,
            "Udieresis"u8,
            "aacute"u8,
            "agrave"u8,
            "acircumflex"u8,
            "adieresis"u8,
            "atilde"u8,
            "aring"u8,
            "ccedilla"u8,
            "eacute"u8,
            "egrave"u8,
            "ecircumflex"u8,
            "edieresis"u8,
            "iacute"u8,
            "igrave"u8,
            "icircumflex"u8,
            "idieresis"u8,
            "ntilde"u8,
            "oacute"u8,
            "ograve"u8,
            "ocircumflex"u8,
            "odieresis"u8,
            "otilde"u8,
            "uacute"u8,
            "ugrave"u8,
            "ucircumflex"u8,
            "udieresis"u8,
            "dagger"u8,
            "degree"u8,
            "cent"u8,
            "sterling"u8,
            "section"u8,
            "bullet"u8,
            "paragraph"u8,
            "germandbls"u8,
            "registered"u8,
            "copyright"u8,
            "trademark"u8,
            "acute"u8,
            "dieresis"u8,
            default,
            "AE"u8,
            "Oslash"u8,
            default,
            "plusminus"u8,
            default,
            default,
            "yen"u8,
            "mu"u8,
            default,
            default,
            default,
            default,
            default,
            "ordfeminine"u8,
            "ordmasculine"u8,
            default,
            "ae"u8,
            "oslash"u8,
            "questiondown"u8,
            "exclamdown"u8,
            "logicalnot"u8,
            default,
            "florin"u8,
            default,
            default,
            "guillemotleft"u8,
            "guillemotright"u8,
            "ellipsis"u8,
            default,
            "Agrave"u8,
            "Atilde"u8,
            "Otilde"u8,
            "OE"u8,
            "oe"u8,
            "endash"u8,
            "emdash"u8,
            "quotedblleft"u8,
            "quotedblright"u8,
            "quoteleft"u8,
            "quoteright"u8,
            "divide"u8,
            default,
            "ydieresis"u8,
            "Ydieresis"u8,
            "fraction"u8,
            "currency"u8,
            "guilsinglleft"u8,
            "guilsinglright"u8,
            "fi"u8,
            "fl"u8,
            "daggerdbl"u8,
            "periodcentered"u8,
            "quotesinglbase"u8,
            "quotedblbase"u8,
            "perthousand"u8,
            "Acircumflex"u8,
            "Ecircumflex"u8,
            "Aacute"u8,
            "Edieresis"u8,
            "Egrave"u8,
            "Iacute"u8,
            "Icircumflex"u8,
            "Idieresis"u8,
            "Igrave"u8,
            "Oacute"u8,
            "Ocircumflex"u8,
            default,
            "Ograve"u8,
            "Uacute"u8,
            "Ucircumflex"u8,
            "Ugrave"u8,
            "dotlessi"u8,
            "circumflex"u8,
            "tilde"u8,
            "macron"u8,
            "breve"u8,
            "dotaccent"u8,
            "ring"u8,
            "cedilla"u8,
            "hungarumlaut"u8,
            "ogonek"u8,
            "caron"u8
        };

        private static readonly PdfString[] macExpert = new PdfString[]
        {
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            "space"u8,
            "exclamsmall"u8,
            "Hungarumlautsmall"u8,
            default,
            "dollaroldstyle"u8,
            "dollarsuperior"u8,
            "ampersandsmall"u8,
            "Acutesmall"u8,
            "parenleftsuperior"u8,
            "parenrightsuperior"u8,
            "twodotenleader"u8,
            "onedotenleader"u8,
            "comma"u8,
            "hyphen"u8,
            "period"u8,
            "fraction"u8,
            "zerooldstyle"u8,
            "oneoldstyle"u8,
            "twooldstyle"u8,
            "threeoldstyle"u8,
            "fouroldstyle"u8,
            "fiveoldstyle"u8,
            "sixoldstyle"u8,
            "sevenoldstyle"u8,
            "eightoldstyle"u8,
            "nineoldstyle"u8,
            "colon"u8,
            "semicolon"u8,
            "commasuperior"u8,
            "threequartersemdash"u8,
            "periodsuperior"u8,
            "questionsmall"u8,
            default,
            "asuperior"u8,
            "bsuperior"u8,
            "centsuperior"u8,
            "dsuperior"u8,
            "esuperior"u8,
            default,
            default,
            default,
            "isuperior"u8,
            default,
            default,
            "lsuperior"u8,
            "msuperior"u8,
            "nsuperior"u8,
            "osuperior"u8,
            default,
            default,
            "rsuperior"u8,
            "ssuperior"u8,
            "tsuperior"u8,
            default,
            "ff"u8,
            "fi"u8,
            "fl"u8,
            "ffi"u8,
            "ffl"u8,
            "parenleftinferior"u8,
            default,
            "parenrightinferior"u8,
            "Circumflexsmall"u8,
            "hyphensuperior"u8,
            "Gravesmall"u8,
            "Asmall"u8,
            "Bsmall"u8,
            "Csmall"u8,
            "Dsmall"u8,
            "Esmall"u8,
            "Fsmall"u8,
            "Gsmall"u8,
            "Hsmall"u8,
            "Ismall"u8,
            "Jsmall"u8,
            "Ksmall"u8,
            "Lsmall"u8,
            "Msmall"u8,
            "Nsmall"u8,
            "Osmall"u8,
            "Psmall"u8,
            "Qsmall"u8,
            "Rsmall"u8,
            "Ssmall"u8,
            "Tsmall"u8,
            "Usmall"u8,
            "Vsmall"u8,
            "Wsmall"u8,
            "Xsmall"u8,
            "Ysmall"u8,
            "Zsmall"u8,
            "colonmonetary"u8,
            "onefitted"u8,
            "rupiah"u8,
            "Tildesmall"u8,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            default,
            "exclamdownsmall"u8,
            "centoldstyle"u8,
            "Lslashsmall"u8,
            default,
            default,
            "Scaronsmall"u8,
            "Zcaronsmall"u8,
            "Dieresissmall"u8,
            "Brevesmall"u8,
            "Caronsmall"u8,
            default,
            "Dotaccentsmall"u8,
            default,
            default,
            "Macronsmall"u8,
            default,
            default,
            "figuredash"u8,
            "hypheninferior"u8,
            default,
            default,
            "Ogoneksmall"u8,
            "Ringsmall"u8,
            "Cedillasmall"u8,
            default,
            default,
            default,
            "onequarter"u8,
            "onehalf"u8,
            "threequarters"u8,
            "questiondownsmall"u8,
            "oneeighth"u8,
            "threeeighths"u8,
            "fiveeighths"u8,
            "seveneighths"u8,
            "onethird"u8,
            "twothirds"u8,
            default,
            default,
            "zerosuperior"u8,
            "onesuperior"u8,
            "twosuperior"u8,
            "threesuperior"u8,
            "foursuperior"u8,
            "fivesuperior"u8,
            "sixsuperior"u8,
            "sevensuperior"u8,
            "eightsuperior"u8,
            "ninesuperior"u8,
            "zeroinferior"u8,
            "oneinferior"u8,
            "twoinferior"u8,
            "threeinferior"u8,
            "fourinferior"u8,
            "fiveinferior"u8,
            "sixinferior"u8,
            "seveninferior"u8,
            "eightinferior"u8,
            "nineinferior"u8,
            "centinferior"u8,
            "dollarinferior"u8,
            "periodinferior"u8,
            "commainferior"u8,
            "Agravesmall"u8,
            "Aacutesmall"u8,
            "Acircumflexsmall"u8,
            "Atildesmall"u8,
            "Adieresissmall"u8,
            "Aringsmall"u8,
            "AEsmall"u8,
            "Ccedillasmall"u8,
            "Egravesmall"u8,
            "Eacutesmall"u8,
            "Ecircumflexsmall"u8,
            "Edieresissmall"u8,
            "Igravesmall"u8,
            "Iacutesmall"u8,
            "Icircumflexsmall"u8,
            "Idieresissmall"u8,
            "Ethsmall"u8,
            "Ntildesmall"u8,
            "Ogravesmall"u8,
            "Oacutesmall"u8,
            "Ocircumflexsmall"u8,
            "Otildesmall"u8,
            "Odieresissmall"u8,
            "OEsmall"u8,
            "Oslashsmall"u8,
            "Ugravesmall"u8,
            "Uacutesmall"u8,
            "Ucircumflexsmall"u8,
            "Udieresissmall"u8,
            "Yacutesmall"u8,
            "Thornsmall"u8,
            "Ydieresissmal"u8
        };

        public static PdfString[] GetEncodingSet(PdfFontEncoding encoding)
        {
            return encoding switch
            {
                PdfFontEncoding.StandardEncoding => standard,
                PdfFontEncoding.WinAnsiEncoding => ansi,
                PdfFontEncoding.MacExpertEncoding => macExpert,
                PdfFontEncoding.MacRomanEncoding => macRoman,
                _ => default,
            };
        }

        public static PdfString GetNameByCode(byte code, PdfFontEncoding encoding, Dictionary<int, PdfString> differences = default)
        {
            if (differences != null && differences.TryGetValue(code, out PdfString name) && !name.IsEmpty)
            {
                return name;
            }

            return encoding switch
            {
                PdfFontEncoding.StandardEncoding => standard[code],
                PdfFontEncoding.MacRomanEncoding => macRoman[code],
                PdfFontEncoding.WinAnsiEncoding => ansi[code],
                PdfFontEncoding.MacExpertEncoding => macExpert[code],
                _ => default,
            };
        }

        public static PdfString GetNameByCodeOrUndefined(byte code, PdfFontEncoding encoding, Dictionary<int, PdfString> differences = default)
        {
            var result = GetNameByCode(code, encoding, differences);

            if (result.IsEmpty)
            {
                return UndefinedCharacter;
            }
            else
            {
                return result;
            }
        }
    }
}
